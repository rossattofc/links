Sub CriarApresentacaoComGraficos()

    ' Declaração das variáveis
    Dim oPPTApp As Object ' Objeto para a aplicação PowerPoint
    Dim oPPTPres As Object ' Objeto para a apresentação do PowerPoint
    Dim oPPTSlide As Object ' Objeto para o slide do PowerPoint
    Dim oExcelApp As Object ' Objeto para a aplicação Excel
    Dim oWorkbook As Object ' Objeto para a pasta de trabalho do Excel
    Dim oWorksheet As Worksheet ' Objeto para a planilha do Excel
    Dim oChartObject As ChartObject ' Objeto para o gráfico
    Dim sPasta As String ' String para o caminho da pasta
    Dim sArquivo As String ' String para o nome do arquivo

    ' Solicita ao usuário que selecione a pasta com as planilhas
    With Application.FileDialog(msoFileDialogFolderPicker)
        .Title = "Selecione a pasta com as planilhas do Excel"
        If .Show = -1 Then
            sPasta = .SelectedItems(1) & "\"
        Else
            Exit Sub ' Sai da sub se nenhuma pasta for selecionada
        End If
    End With

    ' Tenta obter uma instância existente do PowerPoint
    On Error Resume Next
    Set oPPTApp = GetObject(, "PowerPoint.Application")
    On Error GoTo 0

    ' Se o PowerPoint não estiver aberto, cria uma nova instância
    If oPPTApp Is Nothing Then
        Set oPPTApp = CreateObject("PowerPoint.Application")
    End If
    oPPTApp.Visible = True

    ' Cria uma nova apresentação no PowerPoint
    Set oPPTPres = oPPTApp.Presentations.Add

    ' Inicia o loop para encontrar os arquivos Excel na pasta
    sArquivo = Dir(sPasta & "*.xls*")

    Do While sArquivo <> ""
        ' Abre a planilha do Excel
        Set oWorkbook = Workbooks.Open(sPasta & sArquivo)

        ' Adiciona um novo slide na apresentação para cada planilha
        Set oPPTSlide = oPPTPres.Slides.Add(oPPTPres.Slides.Count + 1, 12) ' 12 = ppLayoutBlank

        ' Adiciona o nome do arquivo como título do slide
        oPPTSlide.Shapes.AddTitle.TextFrame.TextRange.Text = "Gráficos de: " & oWorkbook.Name

        ' Loop através de cada planilha no workbook
        For Each oWorksheet In oWorkbook.Worksheets
            ' Loop através de cada gráfico na planilha
            For Each oChartObject In oWorksheet.ChartObjects
                ' Copia o gráfico
                oChartObject.Copy

                ' Cola o gráfico no slide do PowerPoint
                oPPTSlide.Shapes.Paste.Select

                ' Opcional: Ajusta a posição e o tamanho do gráfico colado
                With oPPTApp.ActiveWindow.Selection.ShapeRange
                    .Left = 50 ' Posição a partir da esquerda
                    .Top = 150 ' Posição a partir do topo
                    ' .Width = 400 ' Largura
                    ' .Height = 250 ' Altura
                End With
            Next oChartObject
        Next oWorksheet

        ' Fecha a planilha do Excel sem salvar
        oWorkbook.Close SaveChanges:=False

        ' Pega o próximo arquivo na pasta
        sArquivo = Dir
    Loop

    ' Libera as variáveis de objeto
    Set oPPTSlide = Nothing
    Set oPPTPres = Nothing
    Set oPPTApp = Nothing
    Set oWorkbook = Nothing

    MsgBox "A apresentação do PowerPoint foi criada com sucesso!", vbInformation

End Sub
