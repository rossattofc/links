Sub CopiarGraficosParaPowerPoint()
Dim pptApp As Object
Dim pptPres As Object
Dim pptSlide As Object
Dim xlApp As Object
Dim xlWorkbook As Object
Dim xlWorksheet As Object
Dim cht As Object
Dim fso As Object
Dim folder As Object
Dim file As Object
Dim pastaArquivos As String
Dim tituloSlide As String
Dim slideCount As Integer

```
' Definir o caminho da pasta com os arquivos Excel
pastaArquivos = "C:\SeuCaminho\Pasta\" ' ALTERE ESTE CAMINHO

' Verificar se a pasta existe
Set fso = CreateObject("Scripting.FileSystemObject")
If Not fso.FolderExists(pastaArquivos) Then
    MsgBox "Pasta não encontrada: " & pastaArquivos
    Exit Sub
End If

' Criar ou conectar ao PowerPoint
On Error Resume Next
Set pptApp = GetObject(, "PowerPoint.Application")
If pptApp Is Nothing Then
    Set pptApp = CreateObject("PowerPoint.Application")
End If
On Error GoTo 0

pptApp.Visible = True

' Criar nova apresentação
Set pptPres = pptApp.Presentations.Add

' Criar ou conectar ao Excel
On Error Resume Next
Set xlApp = GetObject(, "Excel.Application")
If xlApp Is Nothing Then
    Set xlApp = CreateObject("Excel.Application")
End If
On Error GoTo 0

xlApp.Visible = False
xlApp.DisplayAlerts = False

slideCount = 0

' Percorrer todos os arquivos da pasta
Set folder = fso.GetFolder(pastaArquivos)

For Each file In folder.Files
    ' Verificar se é arquivo Excel
    If LCase(Right(file.Name, 4)) = ".xls" Or _
       LCase(Right(file.Name, 5)) = ".xlsx" Or _
       LCase(Right(file.Name, 5)) = ".xlsm" Then
        
        On Error Resume Next
        
        ' Abrir arquivo Excel
        Set xlWorkbook = xlApp.Workbooks.Open(file.Path)
        
        If Not xlWorkbook Is Nothing Then
            ' Usar a primeira planilha
            Set xlWorksheet = xlWorkbook.Worksheets(1)
            
            ' Obter título da célula C1
            tituloSlide = xlWorksheet.Range("C1").Value
            If tituloSlide = "" Then
                tituloSlide = "Gráficos - " & xlWorkbook.Name
            End If
            
            ' Verificar se há gráficos na planilha
            If xlWorksheet.ChartObjects.Count > 0 Then
                slideCount = slideCount + 1
                
                ' Criar novo slide
                Set pptSlide = pptPres.Slides.Add(slideCount, 1) ' Layout em branco
                
                ' Adicionar título ao slide
                If pptSlide.Shapes.HasTitle Then
                    pptSlide.Shapes.Title.TextFrame.TextRange.Text = tituloSlide
                Else
                    ' Se não houver caixa de título, criar uma
                    With pptSlide.Shapes.AddTextbox(1, 50, 50, 600, 80)
                        .TextFrame.TextRange.Text = tituloSlide
                        .TextFrame.TextRange.Font.Size = 24
                        .TextFrame.TextRange.Font.Bold = True
                    End With
                End If
                
                ' Copiar todos os gráficos da planilha
                Dim posY As Single
                Dim posX As Single
                Dim chartWidth As Single
                Dim chartHeight As Single
                
                posY = 120 ' Posição inicial Y (abaixo do título)
                posX = 50  ' Posição inicial X
                chartWidth = 300  ' Largura padrão do gráfico
                chartHeight = 200 ' Altura padrão do gráfico
                
                For Each cht In xlWorksheet.ChartObjects
                    ' Copiar gráfico
                    cht.Copy
                    
                    ' Colar no PowerPoint
                    pptSlide.Shapes.Paste
                    
                    ' Ajustar posição e tamanho do gráfico colado
                    With pptSlide.Shapes(pptSlide.Shapes.Count)
                        .Left = posX
                        .Top = posY
                        .Width = chartWidth
                        .Height = chartHeight
                    End With
                    
                    ' Ajustar posição para próximo gráfico
                    posX = posX + chartWidth + 20
                    
                    ' Se ultrapassar a largura do slide, ir para próxima linha
                    If posX + chartWidth > 650 Then
                        posX = 50
                        posY = posY + chartHeight + 20
                    End If
                    
                    ' Limpar clipboard
                    xlApp.CutCopyMode = False
                Next cht
                
                MsgBox "Processado: " & file.Name & " (" & xlWorksheet.ChartObjects.Count & " gráficos)"
                
            Else
                MsgBox "Nenhum gráfico encontrado em: " & file.Name
            End If
            
            ' Fechar arquivo Excel
            xlWorkbook.Close False
            Set xlWorkbook = Nothing
            
        Else
            MsgBox "Erro ao abrir arquivo: " & file.Name
        End If
        
        On Error GoTo 0
    End If
Next file

' Limpar objetos
xlApp.DisplayAlerts = True
xlApp.Quit
Set xlApp = Nothing
Set pptApp = Nothing
Set fso = Nothing

If slideCount > 0 Then
    MsgBox "Processo concluído! " & slideCount & " slides criados."
Else
    MsgBox "Nenhum arquivo com gráficos foi encontrado."
End If
```

End Sub

’ Sub auxiliar para testar se o PowerPoint está disponível
Function PowerPointDisponivel() As Boolean
On Error Resume Next
Dim pptTest As Object
Set pptTest = CreateObject(“PowerPoint.Application”)
PowerPointDisponivel = (Err.Number = 0)
If Not pptTest Is Nothing Then pptTest.Quit
Set pptTest = Nothing
On Error GoTo 0
End Function
