Sub CriarApresentacaoComGraficos_Corrigido()

    ' Declaração das variáveis
    Dim oPPTApp As Object         ' Objeto para a aplicação PowerPoint
    Dim oPPTPres As Object        ' Objeto para a apresentação do PowerPoint
    Dim oPPTSlide As Object       ' Objeto para o slide do PowerPoint
    Dim oWorkbook As Object       ' Objeto para a pasta de trabalho do Excel
    Dim oWorksheet As Worksheet   ' Objeto para a planilha do Excel
    Dim oChartObject As ChartObject ' Objeto para o gráfico
    Dim sPasta As String          ' String para o caminho da pasta
    Dim sArquivo As String        ' String para o nome do arquivo
    Dim topPos As Single          ' Variável para controlar a posição vertical dos gráficos
    Dim leftPos As Single         ' Variável para controlar a posição horizontal dos gráficos

    ' Habilita o tratamento de erros para o caso do PowerPoint não estar aberto
    On Error Resume Next
    Set oPPTApp = GetObject(, "PowerPoint.Application")
    If Err.Number <> 0 Then
        Set oPPTApp = CreateObject("PowerPoint.Application")
    End If
    On Error GoTo 0
    oPPTApp.Visible = True

    ' Solicita ao usuário que selecione a pasta
    With Application.FileDialog(msoFileDialogFolderPicker)
        .Title = "Selecione a pasta com as planilhas do Excel"
        If .Show = -1 Then
            sPasta = .SelectedItems(1) & "\"
        Else
            MsgBox "Nenhuma pasta selecionada. Operação cancelada.", vbExclamation
            Exit Sub
        End If
    End With

    ' Cria uma nova apresentação vazia
    Set oPPTPres = oPPTApp.Presentations.Add

    ' Inicia o loop para encontrar os arquivos Excel na pasta
    sArquivo = Dir(sPasta & "*.xls*")

    Do While sArquivo <> ""
        ' Abre a pasta de trabalho do Excel em modo somente leitura
        Set oWorkbook = Workbooks.Open(Filename:=sPasta & sArquivo, ReadOnly:=True)

        ' >>> ALTERAÇÃO LÓGICA IMPORTANTE <<<
        ' Loop através de cada PLANILHA (aba) dentro do arquivo
        For Each oWorksheet In oWorkbook.Worksheets

            ' Verifica se a planilha atual tem pelo menos um gráfico
            If oWorksheet.ChartObjects.Count > 0 Then

                ' Se tiver gráficos, SÓ ENTÃO cria um novo slide
                Set oPPTSlide = oPPTPres.Slides.Add(oPPTPres.Slides.Count + 1, 12) ' 12 = ppLayoutBlank
                
                ' Adiciona um pequeno título no slide com o nome do arquivo e da aba
                 oPPTSlide.Shapes.AddTextbox(1, 50, 20, 800, 40).TextFrame.TextRange.Text = oWorkbook.Name & " - " & oWorksheet.Name


                ' Zera as posições para os gráficos de cada nova planilha
                topPos = 100
                leftPos = 60

                ' Loop através de cada objeto de gráfico na planilha
                For Each oChartObject In oWorksheet.ChartObjects
                    
                    ' Copia o gráfico como imagem
                    oChartObject.Chart.CopyPicture Appearance:=xlScreen, Format:=xlPicture

                    ' >>> ALTERAÇÃO NA COLAGEM <<<
                    ' Cola o gráfico no slide. Usamos .PasteSpecial para mais controle.
                    oPPTSlide.Shapes.PasteSpecial(DataType:=2).Select ' 2 = ppPasteEnhancedMetafile para boa qualidade

                    ' Posiciona e redimensiona o gráfico colado para não sobrepor
                    With oPPTApp.ActiveWindow.Selection.ShapeRange
                        .Top = topPos
                        .Left = leftPos
                        .Width = 400 ' Define uma largura padrão
                        .Height = 250 ' Define uma altura padrão
                    End With

                    ' Atualiza a posição para o próximo gráfico ir para o lado
                    leftPos = leftPos + 420 ' Largura (400) + Espaço (20)

                    ' Se a próxima posição sair da tela, quebra a linha
                    If leftPos > oPPTPres.PageSetup.SlideWidth - 400 Then
                        leftPos = 60
                        topPos = topPos + 270 ' Altura (250) + Espaço (20)
                    End If

                Next oChartObject
            End If
        Next oWorksheet

        ' Fecha a pasta de trabalho do Excel
        oWorkbook.Close SaveChanges:=False

        ' Pega o próximo arquivo na pasta
        sArquivo = Dir
    Loop

    oPPTApp.ActiveWindow.Selection.Unselect
    Set oPPTSlide = Nothing
    Set oPPTPres = Nothing
    Set oPPTApp = Nothing
    Set oWorkbook = Nothing

    MsgBox "A apresentação do PowerPoint foi criada com sucesso!", vbInformation

End Sub
